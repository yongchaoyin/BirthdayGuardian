<!--pages/birthdays/list.wxml-->
<view class="container">
  <!-- 头部统计 -->
  <view class="header-stats">
    <view class="stat-item">
      <text class="stat-value">{{totalCount}}</text>
      <text class="stat-label">守护对象</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-value">{{remainingSlots}}</text>
      <text class="stat-label">剩余名额</text>
    </view>
  </view>

  <!-- 添加按钮 -->
  <view class="add-button-container" wx:if="{{remainingSlots > 0}}">
    <button class="btn-add" bindtap="goToAdd">
      <text class="btn-add-icon">➕</text>
      <text class="btn-add-text">添加生日提醒</text>
    </button>
  </view>

  <!-- 生日列表 -->
  <view class="birthday-list" wx:if="{{birthdayList.length > 0}}">
    <view class="birthday-card" wx:for="{{birthdayList}}" wx:key="id">
      <view class="card-header">
        <view class="role-info">
          <text class="role-type">{{item.roleType}}</text>
          <text class="role-name">{{item.roleName}}</text>
        </view>
        <view class="countdown-badge">
          <text class="countdown-number">{{item.daysUntil}}</text>
          <text class="countdown-unit">天后</text>
        </view>
      </view>

      <view class="card-body">
        <view class="info-row">
          <text class="info-icon">🎂</text>
          <text class="info-text">{{item.birthDate}}</text>
          <text class="info-tag">{{item.calendarTypeText}}</text>
        </view>

        <view class="info-row" wx:if="{{item.remindDays}}">
          <text class="info-icon">⏰</text>
          <text class="info-text">提前 {{item.remindDays}} 天提醒</text>
        </view>

        <view class="info-row" wx:if="{{item.rolePhone}}">
          <text class="info-icon">📱</text>
          <text class="info-text">{{item.rolePhone}}</text>
        </view>

        <view class="info-row" wx:if="{{item.remark}}">
          <text class="info-icon">📝</text>
          <text class="info-text">{{item.remark}}</text>
        </view>
      </view>

      <view class="card-footer">
        <button class="btn-action" bindtap="handleEdit" data-id="{{item.id}}">
          <text class="action-icon">✏️</text>
          <text class="action-text">编辑</text>
        </button>
        <button class="btn-action btn-danger" bindtap="handleDelete" data-id="{{item.id}}" data-name="{{item.roleName}}">
          <text class="action-icon">🗑️</text>
          <text class="action-text">删除</text>
        </button>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">📅</text>
    <text class="empty-text">还没有添加生日提醒</text>
    <text class="empty-hint">点击上方按钮添加您关心的人</text>
  </view>

  <!-- 名额用完提示 -->
  <view class="quota-notice" wx:if="{{remainingSlots === 0}}">
    <view class="notice-content">
      <text class="notice-icon">⚠️</text>
      <text class="notice-text">守护名额已用完</text>
      <text class="notice-hint" wx:if="{{membershipLevel === 'FREE'}}">升级VIP可守护20位亲友</text>
    </view>
  </view>
</view>
