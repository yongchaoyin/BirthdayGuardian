# 生日守护者 · 项目功能与进度记录

更新时间：2025-10-09 02:05:22

## 一、项目概览
- 目标：提供一个帮助用户记录亲友生日并提前触发温馨提醒的全栈系统。
- 技术栈：Java 17 / Spring Boot 2.7、MyBatis-Plus、MySQL、JWT、Spring Mail、Vue3、Vite、Element Plus、Docker & Compose。

## 二、当前主要功能
1. **账户体系**
   - 用户注册与登录（支持用户名/邮箱登录，JWT 鉴权）。
   - 个人中心可修改用户名、邮箱、手机号、密码，并实时刷新本地信息。
   - 支持绑定微信公众号账号，为后续消息推送做准备。

2. **生日守护功能**
   - 支持添加/编辑/删除生日角色，涵盖阳历与阴历，自动转换阴阳历。
   - 自定义提前提醒天数、备注说明。
   - 温馨体验会员可添加 3 位亲友，VIP 守护礼遇可添加 20 位亲友。
   - 邮件提醒采用暖心文案模板，记录发送日志。
   - 角色支持填写电话，VIP 用户生日当日会自动发送备注短信给该角色。

3. **会员体系**
   - `FREE`（温馨体验）与 `VIP`（挚爱守护）两档：
     - VIP 有效期 1 年，过期自动降级为温馨体验。
     - 登录、获取角色列表等接口均返回会员状态和剩余名额。
   - 管理员后台可一键升/降级会员，立即刷新权益信息；用户如需开通 VIP 可邮件联系站主。

4. **提醒及日志**
   - 每日定时任务（默认 09:00）遍历生日角色，匹配提醒条件后发送邮件。
   - 通知日志表 `notification_log` 记录渠道、结果、标题、内容摘要与触发日期，为后续统计/排查提供依据。
   - 邮件/短信/微信发送量可在管理端折线图查看趋势。

5. **管理员后台**
   - 用户分页管理：查看账号信息、变更角色、删除用户。
   - 会员管理：展示会员等级、可守护名额、VIP 到期时间，可直接升级/降级。
   - 仪表盘统计：
     - 用户结构（总数、管理员、VIP、温馨体验）。
     - 今日/明日生日人数、计划发送的邮件/短信数量。
     - 当日已发送的邮件/短信数量（基于通知日志）。
   - 公告管理：CRUD 公告并在前台展示。
   - 通知工具：支持一键群发邮件/短信至所有填写邮箱/手机的用户。
   - 通知趋势：折线图展示近 14 天邮件与短信发送量，便于观察活跃度。

6. **部署支持**
   - Docker Compose 一键启动 MySQL、后端、前端。
   - 提供 `.env` 模板配置邮件参数，脚本化启动/停止流程。

## 三、数据结构更新速览
- `user` 表新增 `membership_level`、`vip_expire_time`、`phone` 字段。
- `birthday_role` 表新增 `role_phone` 字段。
- 新增 `notification_log` 表，用于记录邮件/短信发送情况。
- 实体 / DTO / Service 已同步调整，前端请求响应字段也已更新。

## 四、当前进度状态
| 模块 | 完成情况 | 说明 |
| --- | --- | --- |
| 基础认证 & 用户管理 | ✅ | 注册、登录、JWT、个人中心完备 |
| 生日角色管理 | ✅ | 会员限额、阴阳历转换、本地操作完成 |
| 邮件提醒 | ✅ | 定时任务+暖心文案+发送日志已上线 |
| 会员体系 | ✅ | 免费/VIP 切换、过期处理、前后端联动 |
| 管理员后台 | ✅ | 用户、公告、统计、会员升级界面与接口完成 |
| Docker 部署 | ✅ | 前后端多阶段构建，Compose 支持 |
| 短信提醒 | ⚠️ 内测 | VIP 生日当日短信功能已接入模拟通道，待对接正式短信服务 |
| 微信公众号 | ⚠️ 内测 | 支持绑定与模板消息发送，尚需填充真实凭证及菜单/跳转配置 |
| 自动化测试 | ⏳ 待补充 | 目前以手动验证为主，后续可增加单元/集成测试 |
| 国际化/多语言 | ⏳ 规划中 | 现有文案以中文为主，可考虑后续扩展 |

## 五、下一步建议
1. **短信通道**：接入正式服务商（如阿里云、腾讯云或 Twilio），替换当前模拟发送并完善成本监控。
2. **队列与重试机制**：为邮件/短信发送增加异步队列和重试，提升高峰期稳定性。
3. **系统监控**：接入日志聚合与告警（如 Prometheus + Grafana），监控任务执行与通知失败率。
4. **自动化测试**：补充后端单元测试 / 集成测试以及前端端到端测试，保障回归质量。
5. **国际化支持**：根据后续用户人群，扩展多语言界面与文案。
6. **会员运营**：后续可加入自动化 VIP 审核，目前通过邮箱 `yinyc0925@outlook.com` 手动处理。
7. **公众号菜单/H5 集成**：建设公众号内的 H5/小程序页面，打通注册/角色管理流程。

---
如需更新此文档，请在关键功能上线或需求变更后同步维护，确保团队成员及时掌握最新进展。
