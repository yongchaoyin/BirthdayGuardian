# 管理员后台功能说明

## 已完成功能

### 1. 数据库改造
- ✅ 给`user`表添加`role`字段,用于区分管理员(admin)和普通用户(user)
- ✅ 创建`announcement`公告表,包含标题、内容、状态等字段
- ✅ 创建默认管理员账号:
  - 用户名: `admin`
  - 密码: `admin@123`
  - 角色: admin

### 2. 后端功能

#### 实体类
- ✅ 更新`User`实体类,添加role字段
- ✅ 创建`Announcement`实体类

#### Controller & Service
- ✅ `AnnouncementController` - 公告管理接口
  - GET `/api/announcements/active` - 获取启用的公告(公开访问)
  - GET `/api/announcements/list` - 分页获取所有公告(管理员)
  - POST `/api/announcements` - 创建公告(管理员)
  - PUT `/api/announcements/{id}` - 更新公告(管理员)
  - DELETE `/api/announcements/{id}` - 删除公告(管理员)

- ✅ `AdminController` - 管理员后台接口
  - GET `/api/admin/stats` - 获取用户统计信息
  - GET `/api/admin/users` - 分页获取用户列表(支持搜索)
  - PUT `/api/admin/users/{id}/role` - 更新用户角色
  - DELETE `/api/admin/users/{id}` - 删除用户

#### 登录增强
- ✅ 登录接口返回用户角色(role字段)
- ✅ 注册时默认赋予用户"user"角色

### 3. 前端功能

#### 管理员后台页面 (`/admin`)
- ✅ 统计卡片:显示总用户数、管理员数、普通用户数
- ✅ 用户管理标签页:
  - 用户列表展示(用户名、邮箱、角色、注册时间)
  - 搜索功能(按用户名或邮箱)
  - 角色管理(可切换用户为admin或user)
  - 删除用户功能
  - 分页功能
- ✅ 公告管理标签页:
  - 公告列表展示
  - 发布新公告
  - 编辑公告
  - 删除公告
  - 启用/禁用公告状态
  - 分页功能

#### 用户页面增强
- ✅ Home页面添加公告展示区域
  - 只展示启用状态的公告
  - 显示公告标题、内容、发布时间
  - 卡片式布局,醒目美观

#### 路由和权限
- ✅ 添加`/admin`路由,仅管理员可访问
- ✅ 路由守卫:检查用户role,非管理员访问admin页面会被拦截
- ✅ 登录后根据角色跳转:
  - 管理员 -> `/admin`
  - 普通用户 -> `/home`

### 4. API接口

#### 前端API文件
- ✅ `src/api/admin.js` - 管理员后台API
- ✅ `src/api/announcement.js` - 公告API

## 使用说明

### 管理员登录
1. 访问登录页面
2. 使用管理员账号登录:
   - 用户名: `admin`
   - 密码: `admin@123`
3. 登录成功后自动跳转到管理员后台页面

### 管理员功能
1. **查看统计信息**: 页面顶部显示用户统计数据
2. **用户管理**:
   - 查看所有注册用户
   - 搜索特定用户
   - 修改用户角色
   - 删除用户(不能删除自己)
3. **公告管理**:
   - 发布新公告
   - 编辑已有公告
   - 删除公告
   - 启用/禁用公告

### 普通用户功能
1. 登录后在首页顶部可以看到启用的公告
2. 公告按时间倒序排列,最新的在最前面

## 技术实现

### 后端
- Spring Boot 2.7.14
- MyBatis Plus
- MySQL 8.0
- JWT认证

### 前端
- Vue 3
- Vue Router
- Element Plus
- Axios

## 部署状态
- ✅ 数据库迁移完成
- ✅ 后端服务运行正常(端口:8089)
- ✅ 功能测试通过
  - 管理员登录成功
  - 用户统计API正常
  - 公告创建成功

## 下一步建议
1. 前端构建和部署
2. 完整的端到端测试
3. 可以考虑添加更多管理功能:
   - 公告分类
   - 定时发布公告
   - 用户活动日志
   - 数据导出功能
