<!--pages/birthdays/list.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ç»Ÿè®¡ -->
  <view class="header-stats">
    <view class="stat-item">
      <text class="stat-value">{{totalCount}}</text>
      <text class="stat-label">å®ˆæŠ¤å¯¹è±¡</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-value">{{remainingSlots}}</text>
      <text class="stat-label">å‰©ä½™åé¢</text>
    </view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-button-container" wx:if="{{remainingSlots > 0}}">
    <button class="btn-add" bindtap="goToAdd">
      <text class="btn-add-icon">â•</text>
      <text class="btn-add-text">æ·»åŠ ç”Ÿæ—¥æé†’</text>
    </button>
  </view>

  <!-- ç”Ÿæ—¥åˆ—è¡¨ -->
  <view class="birthday-list" wx:if="{{birthdayList.length > 0}}">
    <view class="birthday-card" wx:for="{{birthdayList}}" wx:key="id">
      <view class="card-header">
        <view class="role-info">
          <text class="role-type">{{item.roleType}}</text>
          <text class="role-name">{{item.roleName}}</text>
        </view>
        <view class="countdown-badge">
          <text class="countdown-number">{{item.daysUntil}}</text>
          <text class="countdown-unit">å¤©å</text>
        </view>
      </view>

      <view class="card-body">
        <view class="info-row">
          <text class="info-icon">ğŸ‚</text>
          <text class="info-text">{{item.birthDate}}</text>
          <text class="info-tag">{{item.calendarTypeText}}</text>
        </view>

        <view class="info-row" wx:if="{{item.remindDays}}">
          <text class="info-icon">â°</text>
          <text class="info-text">æå‰ {{item.remindDays}} å¤©æé†’</text>
        </view>

        <view class="info-row" wx:if="{{item.rolePhone}}">
          <text class="info-icon">ğŸ“±</text>
          <text class="info-text">{{item.rolePhone}}</text>
        </view>

        <view class="info-row" wx:if="{{item.remark}}">
          <text class="info-icon">ğŸ“</text>
          <text class="info-text">{{item.remark}}</text>
        </view>
      </view>

      <view class="card-footer">
        <button class="btn-action" bindtap="handleEdit" data-id="{{item.id}}">
          <text class="action-icon">âœï¸</text>
          <text class="action-text">ç¼–è¾‘</text>
        </button>
        <button class="btn-action btn-danger" bindtap="handleDelete" data-id="{{item.id}}" data-name="{{item.roleName}}">
          <text class="action-icon">ğŸ—‘ï¸</text>
          <text class="action-text">åˆ é™¤</text>
        </button>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ“…</text>
    <text class="empty-text">è¿˜æ²¡æœ‰æ·»åŠ ç”Ÿæ—¥æé†’</text>
    <text class="empty-hint">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ æ‚¨å…³å¿ƒçš„äºº</text>
  </view>

  <!-- åé¢ç”¨å®Œæç¤º -->
  <view class="quota-notice" wx:if="{{remainingSlots === 0}}">
    <view class="notice-content">
      <text class="notice-icon">âš ï¸</text>
      <text class="notice-text">å®ˆæŠ¤åé¢å·²ç”¨å®Œ</text>
      <text class="notice-hint" wx:if="{{membershipLevel === 'FREE'}}">å‡çº§VIPå¯å®ˆæŠ¤20ä½äº²å‹</text>
    </view>
  </view>
</view>
